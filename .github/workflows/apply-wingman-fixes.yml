permissions:
  contents: write
  pull-requests: write
  issues: write
  id-token: write

name: Apply Wingman Fixes

on:
  issue_comment:
    types:
      - created

jobs:
  apply-fixes:
    runs-on: ubuntu-latest
    steps:
      - name: Log Debug Information
        run: |
          echo "::group::Webhook Payload & Environment"
          echo "Event Name: ${{ github.event_name }}"
          echo "Issue Number: ${{ github.event.issue.number }}"
          echo "Commenter Username: ${{ github.event.comment.user.login }}"
          echo "Commenter Type: ${{ github.event.comment.user.type }}"
          echo "Is Bot: ${{ github.event.comment.user.type == 'Bot' }}"
          echo "Match Wingman/Fly-CI: ${{ contains(github.event.comment.user.login, 'wingman') || contains(github.event.comment.user.login, 'fly-ci') }}"
          echo "Actor: ${{ github.actor }}"
          echo "Repository: ${{ github.repository }}"
          echo "Workflow Permissions:"
          echo "  - contents: write"
          echo "  - pull-requests: write"
          echo "  - issues: write"
          echo "  - id-token: write"
          echo "::endgroup::"
        shell: bash
      
      - name: Verify Environment Variables
        run: |
          echo "::group::Environment Variables"
          env | sort
          echo "::endgroup::"
        shell: bash